<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>World</title>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0'>
    <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css' integrity='sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO' crossorigin='anonymous'>
    <link rel='stylesheet' href='./css/dat.gui.css'>
    <link rel='stylesheet' href='./css/main.css'>
  </head>
  <body>
    <header>
      <nav class='navbar navbar-dark bg-dark'>
        <span class='navbar-text'>
          <h5>
            <strong>DaVE</strong> &nbsp; <small>Datacenter Visualization Environment</small>
          </h5>
        </span>
        <span class='navbar-text pull-right'>
          <span class='info-user pl-0 pr-2'>
            <span class='js-username pr-2'><em>Logged out</em></span>
          </span>
          <span class='info-time px-2'>
            <span class='js-time'>&middot;</span>
          </span>
          <span class='info-actions pl-2 pr-0'>
            <button class='btn btn-outline-danger btn-sm mr-1 js-btn-logout hide' type='button'>Log out</button>
            <button class='btn btn-outline-success btn-sm mr-1 js-btn-login' type='button'>Log in</button>
            <button class='btn btn-outline-primary btn-sm mr-0 js-btn-stats' type='button'>Stats</button>
          </span>
        </span>
      </nav>
    </header>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js' integrity='sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=' crossorigin='anonymous'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js' integrity='sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49' crossorigin='anonymous'></script>
    <script src='https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js' integrity='sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy' crossorigin='anonymous'></script>

    <script src='./js/three.js'></script>
    <script src='./js/controls/OrbitControls.js'></script>
    <script src='./js/objects/Reflector.js'></script>
    <script src='./js/loaders/MTLLoader.js'></script>
    <script src='./js/loaders/OBJLoader.js'></script>
    <script src='./js/WebGL.js'></script>
    <script src='./js/libs/stats.min.js'></script>
    <script src='./js/libs/dat.gui.min.js'></script>
    <script src='./js/GPUParticleSystem.js'></script>
    <script src='./js/moment.min.js'></script>
    <script src='./js/Chart.min.js'></script>
    <script src='./js/chartjs-plugin-streaming.min.js'></script>

    <script>
      if (WEBGL.isWebGLAvailable() === false) {
        document.body.appendChild(WEBGL.getWebGLErrorMessage());
      }

      var scene, camera, renderer, mesh, groundMirror, grid, mrrFadeout, spotLight, gndTexture, sky, particleSystem, controls;
      var vport, vpcam, vprend, vpobj
      var sqSize = 100
      var subSqSize = sqSize / 5
      var globalObjects = []
      var noClickObjects = ['Ground', 'Grid', 'FadeoutMrr', 'GndMirror', 'GndMrr']
      var posMap = []
      var posX0 = -10
      var posZ0 = -10
      var cPosX = -10
      var cPosZ = -10
      var maxX = 8
      var maxZ = 8
      var stepX = 1
      var stepZ = 2
      var count = 0
      var rotation, link, traffic, clock = new THREE.Clock(), tick = 0

      var ptxOptions = {
        position: new THREE.Vector3(637, 1, 373),
        positionRandomness: 0.44, //0.25,
        velocity: new THREE.Vector3(),
        velocityRandomness: 0.18, //0.11,
        color: 0x1bf7f9,
        colorRandomness: 0.5,
        turbulence: 0.02, //0.01,
        lifetime: 1.7, //1,
        size: 5, //3,
        sizeRandomness: 4.3 //0.05
      };

      var spawnerOptions = {
        spawnRate: 1100, //640,
        horizontalSpeed: 1.5,
        verticalSpeed: 1,
        timeScale: 10 //1
      }

      var gridX = [], gridZ = []
      var gOx = 0
      var gOz = 0

      var mtx

      var vportEmpty = true
      var cT, cTi

      var dirLights = []
      var hemiLights = []
      var ghLights = []
      var ambiLight

      var raycaster = new THREE.Raycaster();
      var mouse = new THREE.Vector2();

      function dec2hex(i) {
        var result = '0x000000';
        if (i >= 0 && i <= 15) { result = '0x00000' + i.toString(16); }
        else if (i >= 16 && i <= 255) { result = '0x0000' + i.toString(16); }
        else if (i >= 256 && i <= 4095) { result = '0x000' + i.toString(16); }
        else if (i >= 4096 && i <= 65535) { result = '0x00' + i.toString(16); }
        else if (i >= 65535 && i <= 1048575) { result = '0x0' + i.toString(16); }
        else if (i >= 1048575 ) { result = '0x' + i.toString(16); }
        if (result.length == 8) { return result; }
      }
      var deg2rad = function(degree) { return degree * (Math.PI / 180); }

      var OLDmodelsMap = {
        '1stbuilding':   { scale: 15, oX: 20, oZ: 20, count: 0, model: null, lX: 0,  lY: 35, lZ: 9  },
        '2squerbuild':   { scale: 15, oX: 65, oZ: 50, count: 0, model: null, lX: 0,  lY: 37, lZ: 2  },
        'aqua':          { scale: 0.5, oX: 80, oZ: 40, count: 0, model: null, lX: 0, lY: 60, lZ: 0  },
        '3base':         { scale: 15, oX: 45, oZ: 45, count: 0, model: null, lX: 5,  lY: 40, lZ: 5  },
        'basictall':     { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 300, lZ: 0 },
        'bmw':           { scale: 15, oX: 50, oZ: 75, count: 0, model: null, lX: 0,  lY: 50, lZ: 0  },
        'buildings1':    { scale: 15, oX: 55, oZ: 75, count: 0, model: null, lX: 22, lY: 35, lZ: 1  },
        'castle':        { scale: 0.5, oX: 50, oZ: 50, count: 0, model: null, lX: 0, lY: 35, lZ: 0  },
        'cube_trans':    { scale: 15, oX: 50, oZ: 50, count: 0, model: null, lX: -1, lY: 40, lZ: 1  },
        'lastnode':      { scale: 15, oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 35, lZ: 2  },
        'lighttower':    { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 120, lZ: 0 },
        'longsilos':     { scale: 1,  oX: 50, oZ: 70, count: 0, model: null, lX: 0,  lY: 65,  lZ: 0 },
        'ltrans':        { scale: 0.5, oX: 80, oZ: 80, count: 0, model: null, lX: 0,  lY: 50, lZ: 0 },
        'merscobj':      { scale: 15, oX: 40, oZ: 50, count: 0, model: null, lX: 10, lY: 37, lZ: 2, doubleSided: true },
        'moderntower':   { scale: 15, oX: 80, oZ: 50, count: 0, model: null, lX: 0,  lY: 70, lZ: 0  },
        'prison':        { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 25, lZ: 0  },
        'SciFi_3':       { scale: 15, oX: 15, oZ: 90, count: 0, model: null, lX: 0,  lY: 55, lZ: -7 },
        'scifitower':    { scale: 15, oX: 50, oZ: 80, count: 0, model: null, lX: 0,  lY: 50, lZ: 0  },
        'silos':         { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 75, lZ: 0  },
        'silostrans':    { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 65, lZ: 0  },
        'simple':        { scale: 15, oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 27, lZ: 2  },
        'simlebuilding': { scale: 15, oX: 80, oZ: 20, count: 0, model: null, lX: 0,  lY: 40, lZ: 2  },
        'tallbuilding':  { scale: 15, oX: 20, oZ: 20, count: 0, model: null, lX: 0,  lY: 50, lZ: 0  },
        'tallbuildingb': { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 90, lZ: 0  },
        'tallfix':       { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 90, lZ: 0  },
        'torus':         { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 60, lZ: 0  },
        'transtower':    { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 210, lZ: 0 }
      }
      var logoMap = {
        'Apache_kafka': { scale: 2,  oX: 2,  oZ: 0, model: null, count: 0},
        'centos':       { scale: 6,  oX: 2,  oZ: 3, model: null, count: 0},
        'clickhouse':   { scale: 10, oX: 30, oZ: 0, model: null, count: 0},
        'elastic':      { scale: 3,  oX: 0,  oZ: 0, model: null, count: 0},
        'flink':        { scale: 5,  oX: 0,  oZ: 0, model: null, count: 0},
        'git':          { scale: 5,  oX: 0,  oZ: 6, model: null, count: 0},
        'Prometheus':   { scale: 12, oX: 0,  oZ: 0, model: null, count: 0},
        'spark':        { scale: 5,  oX: 0,  oZ: 0, model: null, count: 0},
        'ubuntu':       { scale: 4,  oX: 0,  oZ: 0, model: null, count: 0},
        'zepelin':      { scale: 6,  oX: 0,  oZ: 2, model: null, count: 0},
        'Zoo':          { scale: 9,  oX: 35, oZ: 0, model: null, count: 0}
      }

      var modelsMap = {
        'Castle_a': { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Cube_a':   { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Round_a':  { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Silos_a':  { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Tower_a':  { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        
        'Castle_c': { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Cube_c':   { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Round_c':  { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Silos_c':  { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Tower_c':  { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },

        'Castle_s': { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Cube_s':   { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Round_s':  { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Silos_s':  { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },
        'Tower_s':  { scale: 1, oX: 0, oZ: 0, count: 0, model: null, lX: 0, lY: 100, lZ: 0 },

        'lighttower':  { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 120, lZ: 0 },
        'silos':       { scale: 1,  oX: 50, oZ: 50, count: 0, model: null, lX: 0,  lY: 75, lZ: 0  },
        'moderntower': { scale: 15, oX: 80, oZ: 50, count: 0, model: null, lX: 0,  lY: 70, lZ: 0  },
        'cube_trans':  { scale: 15, oX: 50, oZ: 50, count: 0, model: null, lX: -1, lY: 40, lZ: 1  }
      }

      $(function() {
        init();
        animate();

        Object.getOwnPropertyNames(modelsMap).forEach(function(model) {
          $('#typeSelect').append('<option value="' + model + '">' + model + '</option>')
          $('#typeSelectM').append('<option value="' + model + '">' + model + '</option>')
        })
        Object.getOwnPropertyNames(logoMap).forEach(function(logo) {
          $('#logoSelectM').append('<option value="' + logo + '">' + logo + '</option>')
        })

        $('#addBtn').click(function() {
          var mdl = $('#typeSelect').val()
          if (cPosX <= maxX) {
            cPosX += count === 0? 0 : stepX
          } else {
            cPosX = posX0
            cPosZ += stepZ
          }
          var sqOffset = { x: cPosX, z: cPosZ }
          var tlgo = Object.getOwnPropertyNames(logoMap)
          var trl = rnd(0, tlgo.length - 1)
          var lgo = logoMap[tlgo[trl]]
          addModel(scene, mdl, lgo, sqOffset)

          if (modelsMap[mdl].count) {
            $('.js-object-list tbody').find('.js-count-' + mdl).find('.js-num').html(modelsMap[mdl].count)
          } else {
            $('.js-object-list tbody').append('<tr class="js-count-' + mdl + '"><td>' + mdl + '</td><td class="js-num">1</td></tr>')
          }
          count++
        })
        $('#addBtnMulti').click(function() {
          var count = prompt('Number: ')
          $('#addBtn').trigger('click')
          setTimeout(function() {
            for (var i = 0; i < count; i++) {
              $('#addBtn').trigger('click')
            }
          }, 50, --count)
        })

        $('.js-btn-stats').click(function() {
          $(stats.domElement).toggleClass('hide')
        })

        $('.js-btn-load').click(function() {
          dataAdapter.load()
        })

        userAdapter.init()
        $('.js-btn-login').click(function() {
          userAdapter.doLogin()
        })
        $('.js-btn-logout').click(function() {
          userAdapter.doLogout()
        })

        $('#shInfo').click(function() {
          $('.obj-panel').removeClass('hide')
        })
        $('#shConsole').click(function() {
          $('.obj-panel').removeClass('hide')
        })
        $('#shGraph').click(function() {
          $('.obj-panel').removeClass('hide')
        })

        cTi = setInterval(function() {
          cT = new Date()
          $('.js-time').html(cT.toLocaleTimeString('hr'))
        }, 500)

        $('.dg.ac').css('right', '30rem')

        $('#console').text('neven@Neven-E580:~/Code/DT-demo (master)\r\n[' + (new Date()).toLocaleTimeString('hr') + '] $ ')

        var ctx = document.getElementById('graph').getContext('2d');
        var chart = new Chart(ctx, {
          type: 'line',
          data: {
            datasets: [{
              data: [],
              label: 'Load',
              borderColor: 'rgb(0, 151, 178)',
              backgroundColor: 'rgba(0, 151, 178, 0.5)',
            }]
          },
          options: {
            scales: {
              xAxes: [{
                type: 'realtime',
                realtime: {
                  delay: 2000,
                  onRefresh: function(chart) {
                    chart.data.datasets.forEach(function(dataset) {
                      dataset.data.push({
                        x: Date.now(),
                        y: Math.random()
                      });
                    });
                  }
                }
              }]
            }
          }
        });

        $('#buildForm').submit(function(e) {
          e.preventDefault()
          var loc = $('#inputLoc').val().trim().match(/(\d{1,}),(\d{1,})/i)
          var obj = $('#typeSelectM').val()
          var logo = $('#logoSelectM').val()

          var outloc = [0, 0]
          if (loc instanceof Array) {
            outloc = [loc[1], loc[2]]
          }

          var data = {
            LocationIn3d: outloc,
            Services: [
              {
                Name: 'Builder object',
                Logo: logo,
                Model: obj,
                LocationIn3dTile: [1, 1]
              }
            ]
          }
          placeModels(scene, data)
          $('.builder-modal-lg').modal('hide')
          return false;
        });

        $('#scene').append(vprend.domElement);
      })

      var dataAdapter = {
        // url: 'http://173.249.3.78:29200/df_arch/doc/_search',
        url: '/data/response-demo.json',
        load: function() {
          $.ajax({
            url: this.url,
            crossDomain: true,
            method: 'get',
            dataType: 'json'
          }).done(function(res) {
            var hits = res.hits.hits
            $('#loadBtn').addClass('hide')
            hits.forEach(function(itm) {
              placeModels(scene, itm._source)
            })
          })
        }
      }

      gndTexture = new THREE.TextureLoader().load('./res/obj/hexagon.png')
      sky = new THREE.TextureLoader().load('./res/backgrounds/abstract-digital-blue-grid.jpg')

      function placeModels(scene, cellData) {
        var location = cellData.LocationIn3d
        var objArray = cellData.Services

        var posX = -5 * sqSize + parseInt(location[0], 10) * sqSize
        var posZ = -5 * sqSize + parseInt(location[1], 10) * sqSize

        var geometry = new THREE.BoxBufferGeometry(sqSize, 1, sqSize)
        var material = new THREE.MeshPhongMaterial({ color: 0x010101 })
        var base = new THREE.Mesh(geometry, material)
        base.position.x = posX + sqSize / 2
        base.position.z = posZ + sqSize / 2
        base.userData.name = 'CellBase'
        base.opacity = 0.25

        var cell = new THREE.Group()
        cell.add(base)
        var sqOffset = {
          x: -5 + parseInt(location[0], 10),
          z: -5 + parseInt(location[1], 10)
        }

        var ic = 0
        objArray.forEach(function(obj) {
          console.log('OBJ', obj)
          var mdlArr = Object.getOwnPropertyNames(modelsMap)
          var objModel = mdlArr[rnd(0, mdlArr.length - 1)]
          if (obj.Model) {
            objModel = obj.Model
          }
          var logoModel = obj.Logo
          addModel(cell, objModel, logoModel, sqOffset)
          ic++
        })

        scene.add(cell)
      }

      var stats = new Stats()
      $(stats.domElement).css('top', '3rem').css('right', 0).css('left', '')
      stats.showPanel(0)
      document.body.appendChild(stats.dom)
      $(stats.domElement).addClass('hide')

      function createObject(scene, objName, params, callback) {
        var loader = new THREE.MTLLoader()

        var objPath = './res/obj/'
        if (modelsMap[objName] && modelsMap[objName].hasOwnProperty('doubleSided')) { loader.setMaterialOptions({ side: THREE.DoubleSide }) }
        loader.load(
          objPath + objName + '.mtl',
          function (materials) {
            materials.preload();
            new THREE.OBJLoader()
              .setMaterials(materials).load(objPath + objName + '.obj', function (object) {
                callback(object, params)
              },
              function (xhr) {
                // do nothing
              },
              function (err) {
                console.error('An error happened while loading MTL object.', err);
              }
            )
          }
        )
      }

      function onDocumentMouseUp(event) {
        if (event.button === 0) {
          var lMap = event.path.filter(function(x) { return $(x)[0].id === 'objttip' })
          if (lMap.length > 0) {
            event.preventDefault()
          } else {
            mouse.x = (event.clientX / renderer.domElement.clientWidth) * 2 - 1
            mouse.y = -(event.clientY / renderer.domElement.clientHeight) * 2 + 1
            raycaster.setFromCamera(mouse, camera)

            console.log('CLKx', event.clientX, event.clientY, mouse.x, mouse.y)

            var intersects = raycaster.intersectObjects(scene.children, true)
            if (intersects.length >= 1) {
              if (noClickObjects.indexOf(intersects[0].object.name) === -1) {
                console.log('Clicked object type: ' + intersects[0].object.geometry.name, intersects[0])
                // $('#objttip').css('left', event.x + 50).css('top', event.y).removeClass('hide')
                //$('.obj-panel').removeClass('hide')
                $('.obj-panel .obj-dist').text(intersects[0].distance)
                $('.obj-panel .obj-type').text(intersects[0].object.parent.userData.type)
                $('.obj-panel .obj-uuid').text(intersects[0].object.uuid)

                var sObj = intersects[0].object.parent
                setInspector(sObj, vport)
              } else {
                $('.obj-panel').addClass('hide')
                // clearInspector(vport)
              }
            } else {
              // $('#objttip').addClass('hide')
            }
          }
        }
      }
      document.addEventListener('mouseup', onDocumentMouseUp, false)

      /*
      function onDocumentMouseMove(evt) {
        if (evt.buttons === 1 && evt.button === 0) { // drag!
          var lMap = evt.path.filter(function(x) { return $(x)[0].id === 'objttip' })
          if (lMap.length > 0) {
            $('#objttip').css('left', evt.x - 15).css('top', evt.y - 15)
            evt.preventDefault()
          }
        }
      }
      document.addEventListener('mousemove', onDocumentMouseMove, false)
      */

      function rnd(min, max) {
        return Math.floor(Math.random() * max) + min
      }

      function setupWorld() {
        camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 8000);
        camera.position.set(250, 250, 250);
        camera.translateX(500)
        camera.translateZ(1000)

        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000000);
        scene.fog = new THREE.Fog(0x000000, 1000, 8000);

        // ground
        ground = new THREE.Mesh(new THREE.PlaneBufferGeometry(2000, 2000), new THREE.MeshPhongMaterial({ color: 0xffffff, map: gndTexture, depthWrite: true }));
        ground.name = 'Ground'
        ground.rotation.x = -Math.PI / 2;
        ground.receiveShadow = false;
        ground.opacity = 0.8
        scene.add(ground);

        var geometry = new THREE.PlaneBufferGeometry(2000, 2000);
        geometry.name = 'GndMirror'
        groundMirror = new THREE.Reflector(geometry, {
          clipBias: 0.8,
          textureWidth: window.innerWidth * window.devicePixelRatio,
          textureHeight: window.innerHeight * window.devicePixelRatio,
          color: 0x848484,
          recursion: 1
        });
        groundMirror.name = 'GndMrr'
        groundMirror.position.y = 0.5;
        groundMirror.rotateX(-Math.PI / 2);
        scene.add(groundMirror);

        mrrFadeout = new THREE.Mesh(new THREE.PlaneBufferGeometry(2000, 2000), new THREE.MeshBasicMaterial({ color: 0xffffff, map: gndTexture, opacity : 0.85 , transparent: true }))
        mrrFadeout.name = 'FadeoutMrr'
        mrrFadeout.position.y = 0.85
        mrrFadeout.rotateX(-Math.PI / 2)
        scene.add(mrrFadeout)

        grid = new THREE.GridHelper(1800, 33, 0x01d7d7, 0x01d7d7); //0x3bff7f
        grid.name = 'Grid'
        grid.material.opacity = 1;
        grid.material.transparent = true;
        grid.position.y = 1;
        grid.visible = false;
        scene.add(grid);

        var subGrid = new THREE.GridHelper(2000, 100, 0x449960, 0x449960);
        subGrid.name = 'SubGrid'
        subGrid.material.opacity = 0.75;
        subGrid.material.transparent = true;
        subGrid.position.y = 0.05;
        subGrid.visible = false;
        scene.add(subGrid);

        scene.background = sky

        // hemiLight - main, central
        hemiLights.push(addHemiLight(scene, {
          color: 0xffffff,
          groundColor: 0xaaaaaa,
          intensity: 1,
          coords: { x: 0, y: 1000, z: 0 }
        }))
        // hemiLight - bordering
        hemiLights.push(addHemiLight(scene, {
          color: 0xffffff,
          groundColor: 0xaaaaaa,
          intensity: 1,
          coords: { x: 500, y: 1000, z: 500 }
        }))
        hemiLights.push(addHemiLight(scene, {
          color: 0xffffff,
          groundColor: 0xaaaaaa,
          intensity: 1,
          coords: { x: 500, y: 1000, z: -500 }
        }))
        hemiLights.push(addHemiLight(scene, {
          color: 0xffffff,
          groundColor: 0xaaaaaa,
          intensity: 1,
          coords: { x: -500, y: 1000, z: -500 }
        }))
        hemiLights.push(addHemiLight(scene, {
          color: 0xffffff,
          groundColor: 0xaaaaaa,
          intensity: 1,
          coords: { x: -500, y: 1000, z: 500 }
        }))

        ambiLight = new THREE.AmbientLight(0xffffff, 5)
        scene.add(ambiLight)

        particleSystem = new THREE.GPUParticleSystem({
          maxParticles: 250000
        });
        scene.add(particleSystem);

        var linkShp = new THREE.Shape()
        linkShp.moveTo(638 - 2, 373)
        linkShp.lineTo(638 - 2, 627)
        linkShp.lineTo(638 + 2, 627)
        linkShp.lineTo(638 + 2, 373)
        linkShp.lineTo(638 - 2, 373)

        var exs = {
          steps: 1,
          depth: 2,
          bevelEnabled: false
        }

        var lGeo = new THREE.ExtrudeGeometry(linkShp, exs)
        var lMat = new THREE.MeshBasicMaterial({ color: 0xffffff }) //1bf7f9
        link = new THREE.Mesh(lGeo, lMat)
        link.position.x = 0
        link.position.y = 1
        link.position.z = 0
        link.rotation.x = Math.PI / 2

        var trafGeo = new THREE.BoxGeometry(5, 5, 5)
        var trafMat = new THREE.MeshBasicMaterial({ color: 0xffff00 })
        var trafMesh = new THREE.Mesh(trafGeo, trafMat)
        traffic = new THREE.Group()

        var tmpMesh1 = trafMesh.clone()
        tmpMesh1.position.z = 7
        var tmpMesh2 = trafMesh.clone()
        tmpMesh2.position.z = 14
        traffic.add(trafMesh)
        traffic.add(tmpMesh1)
        traffic.add(tmpMesh2)

        traffic.position.x = 0
        traffic.position.y = 5
        traffic.position.z = 0

        scene.add(traffic)

        var mtG = new THREE.BoxGeometry(5, 5, 5)
        var mtT = new THREE.MeshBasicMaterial({ color: 0xff0000 })
        mtx = new THREE.Mesh(mtG, mtT)
      }

      function setupView(domElm) {
        vpcam = new THREE.PerspectiveCamera(45, $(domElm).width() / $(domElm).height(), 1, 1000);
        vpcam.position.set(100, 50, 100);

        vport = new THREE.Scene();
        vport.background = new THREE.Color(0x000205);
        vport.fog = new THREE.Fog(0x000205, 500, 900);

        var vgnd = new THREE.Mesh(new THREE.PlaneBufferGeometry(500, 500), new THREE.MeshPhongMaterial({ color: 0x000609, depthWrite: true }));
        vgnd.name = 'vGround'
        vgnd.rotation.x = -Math.PI / 2;
        vgnd.receiveShadow = false;
        vgnd.opacity = 0.8
        vport.add(vgnd);

        var vpGeo = new THREE.PlaneBufferGeometry(500, 500);
        vpGeo.name = 'vGndMirror'
        vpGMrr = new THREE.Reflector(vpGeo, {
          clipBias: 0.8,
          textureWidth: $(domElm).width() * window.devicePixelRatio,
          textureHeight: $(domElm).height() * window.devicePixelRatio,
          color: 0x848484,
          recursion: 1
        });
        vpGMrr.name = 'vGndMrr'
        vpGMrr.position.y = 0.5;
        vpGMrr.rotateX(-Math.PI / 2);
        vport.add(vpGMrr);

        vMrrFadeout = new THREE.Mesh(new THREE.PlaneBufferGeometry(500, 500), new THREE.MeshBasicMaterial({ color: 0x3f93ab, opacity : 0.9 , transparent: true }))
        vMrrFadeout.name = 'vFadeoutMrr'
        vMrrFadeout.position.y = 0.85
        vMrrFadeout.rotateX(-Math.PI / 2)
        vport.add(vMrrFadeout)

        var vpsky = new THREE.TextureLoader().load('./res/backgrounds/48113.jpg')
        vport.background = vpsky

        addHemiLight(vport, {
          color: 0xffffff,
          groundColor: 0xaaaaaa,
          intensity: 5,
          coords: { x: 0, y: 250, z: 0 },
          helper: false
        })
        var vambilight = new THREE.AmbientLight(0xffffff, 3)
        vport.add(vambilight)
      }

      function addHemiLight(scene, params) {
        var hemiLight = new THREE.HemisphereLight(params.color, params.groundColor, params.intensity)
        hemiLight.position.set(params.coords.x, params.coords.y, params.coords.z);
        scene.add(hemiLight);
        if (params.helper !== false) {
          var hlHelper = new THREE.HemisphereLightHelper(hemiLight, 50, 0xffff00)
          scene.add(hlHelper);
        }

        return hemiLight
      }
      function addDirLight(scene, params) {
        var dirLight = new THREE.DirectionalLight(params.color, params.intensity)
        dirLight.position.set(params.coords.x, params.coords.y, params.coords.z)
        dirLight.castShadow = false
        dirLight.target.position.set(params.coords.x, 0, params.coords.z)
        scene.add(dirLight)
        scene.add(dirLight.target)

        var dlHelper = new THREE.DirectionalLightHelper(dirLight, 10, 0x0088ff)
        scene.add(dlHelper)

        return dirLight
      }
      function addSpotLight(scene, params) {
        var spotLight = new THREE.SpotLight(params.color, params.intensity)
        spotLight.position.set(params.coords.x, params.coords.y, params.coords.z)
        spotLight.castShadow = false
        spotLight.angle = Math.PI / 4;
        spotLight.penumbra = 0.05;
        spotLight.decay = 2;
        spotLight.distance = 200;
        scene.add(spotLight)

        var slHelper = new THREE.SpotLightHelper(spotLight, 10, 0x0000ff)
        scene.add(slHelper)

        return spotLight
      }

      function setInspector(srcModel, destScene) {
        console.log('Model:', srcModel)
        var rmObj = destScene.getObjectByName('selected')
        destScene.remove(rmObj)

        var destModel = srcModel.clone()
        destModel.position.x = 0
        destModel.position.z = 0
        destModel.name = 'selected'
        destScene.add(destModel)

        vpcam.lookAt(destScene.position)
        vportEmpty = false

        $('.js-ctl').removeClass('hide')

        var box = new THREE.Box3().setFromObject(destModel)
        vpcam.position.x = box.max.x * 5
        vpcam.position.y = box.max.y - 5
        vpcam.position.z = box.max.z * 7.5

        var t = new THREE.Vector3()
        t.x = (box.max.x + box.min.x) / 2
        t.y = (box.max.y + box.min.y) / 2
        t.z = (box.max.z + box.min.z) / 2
        vpcam.lookAt(t)

        console.log('VCam', vpcam.position, t)

        vpobj = destModel
      }
      function clearInspector(destScene) {
        var rmObj = destScene.getObjectByName('selected')
        destScene.remove(rmObj)
        vportEmpty = true
        $('.js-ctl').addClass('hide')
      }

      function addModel(scene, model, logoModel, sqOffset) {
        if (modelsMap[model].model) {
          var mdl = modelsMap[model].model.clone()
          var oX = 0
          var oZ = 0
          if (sqOffset && typeof sqOffset === 'object') {
            oX = sqSize * sqOffset.x
            oZ = sqSize * sqOffset.z
          }
          mdl.position.x = oX + modelsMap[model].oX
          mdl.position.z = oZ + modelsMap[model].oZ
          modelsMap[model].count++

          var group = new THREE.Group();

          var tmpLogoObj = logoMap[logoModel]
          var tlgo = Object.getOwnPropertyNames(logoMap)
          var trl = rnd(0, tlgo.length - 1)
          var lgo = logoMap[tlgo[trl]]
          var logoObj = tmpLogoObj? tmpLogoObj : lgo

          var logo = null
          try {
            logo = logoObj.model.clone()
          } catch(e) {
            console.warn('Could not load logo object:', logoObj, logoModel, e)
          }
          if (logo) {
            var box = new THREE.Box3().setFromObject(mdl)
            logo.position.x = mdl.position.x + (box.max.x - box.min.x) / 2
            logo.position.y = box.max.y + 15
            logo.position.z = mdl.position.z + (box.max.z - box.min.z) / 2
            group.add(logo)
          }
          group.add(mdl)
          scene.add(group)
        } else {
          createObject(scene, model, sqOffset, function(obj, sqOffset) {
            obj.scale.set(modelsMap[model].scale, modelsMap[model].scale, modelsMap[model].scale)
            var oX = 0
            var oZ = 0
            if (sqOffset && typeof sqOffset === 'object') {
              oX = sqSize * sqOffset.x
              oZ = sqSize * sqOffset.z
            }
            obj.position.x = oX + modelsMap[model].oX
            obj.position.z = oZ + modelsMap[model].oZ
            obj.userData.type = model
            modelsMap[model].count = 1
            modelsMap[model].model = obj

            var group = new THREE.Group();
            //var tmpLogoObj = logoMap.find(function(itm) { return logoMap.indexOf(itm.name) > -1 })
            //var tmpLogoObj = logoMap.find(function(itm) { return itm.name == logoModel })
            //var logoObj = tmpLogoObj? tmpLogoObj : logoMap[rnd(0, logoMap.length)]

            var tmpLogoObj = logoMap[logoModel]

            var tlgo = Object.getOwnPropertyNames(logoMap)
            var trl = rnd(0, tlgo.length - 1)
            var lgo = logoMap[tlgo[trl]]

            var logoObj = tmpLogoObj? tmpLogoObj : lgo
            console.log('LO', logoModel, tmpLogoObj)

            var logo = null
            try {
              logo = logoObj.model.clone()
            } catch(e) {
              console.warn('Could not load logo object:', logoObj, logoModel, e)
            }
            if (logo) {
              var box = new THREE.Box3().setFromObject(obj)
              logo.position.x = obj.position.x + (box.max.x - box.min.x) / 2
              logo.position.y = box.max.y + 15
              logo.position.z = obj.position.z + (box.max.z - box.min.z) / 2
              //logo.position.x = obj.position.x + modelsMap[model].lX + logoObj.oX
              //logo.position.y = modelsMap[model].lY + 15
              //logo.position.z = obj.position.z + modelsMap[model].lZ + logoObj.oZ
              group.add(logo)
            }
            group.add(obj)
            scene.add(group);
            // console.log('XE', obj, logo)
          })
        }
      }

      function setConns() {
        addModel(scene, 'lighttower', 'ubuntu', { x: 6, z: 3 })
        addModel(scene, 'silos', 'elastic', { x: 6, z: 6 })

        setTimeout(function() {
          var mt = modelsMap.lighttower.model
          var ms = modelsMap.silos.model

          mt.position.x = 638
          mt.position.z = 373

          ms.position.x = 638
          ms.position.z = 627

          scene.add(link)
        }, 2000)

        addModel(scene, 'moderntower', 'centos', { x: 3, z: 3 })
        addModel(scene, 'cube_trans', 'git', { x: 3, z: 6 })

        setTimeout(function() {
          var mwx = modelsMap.moderntower.model
          var mcx = modelsMap.cube_trans.model
          mwx.position.x = 362
          mwx.position.z = 373
          mcx.position.x = 362
          mcx.position.z = 627

          var link2 = link.clone()
          link2.position.x = -276

          traffic.position.x = 362
          traffic.position.z = 388
          scene.add(link2)
        }, 2000)
      }

      function initLogos() {
        Object.getOwnPropertyNames(logoMap).forEach(function(logo) {
          var sqOffset = {}
          var logoObj = logoMap[logo]
          createObject(scene, 'logos/' + logo, sqOffset, function(obj, sqOffset) {
            obj.scale.set(logoObj.scale, logoObj.scale, logoObj.scale)
            obj.position.x = 10000
            obj.position.z = 10000
            obj.position.y = 10000
            obj.userData.mode = 'logo'
            obj.userData.type = logoObj.name
            obj.rotateX(Math.PI / 2);
            logoObj.count = 0
            logoObj.model = obj
            scene.add(obj);
          })
        })
      }

      function init() {
        setupWorld()
        initLogos()
        setupView(document.getElementById('scene'))

        setTimeout(function() {
          setConns()
        }, 1000)

        gOx = -1000 //-915
        gOz = -1000 //-873
        gSx = 50
        gSz = 50
        var fX = 0
        var fZ = 0

        var markers = new THREE.Group()
        for (var gi = 0; gi <= 40; gi++) {
          var tmp = mtx.clone()
          tmp.position.x = gOx + (gi * gSx)
          tmp.position.z = gOz + (gi * gSz)
          gridX.push(gOx + (gi * gSx))
          gridZ.push(gOz + (gi * gSz))
          markers.add(tmp)
        }
        scene.add(markers)

        /*
        dirLights[0] = addDirLight(scene, {
          color: 0xffffff,
          intensity: 3,
          coords: { x: -200, y: 1000, z: 200 }
        })
        dirLights[1] = addDirLight(scene, {
          color: 0xffffff,
          intensity: 3,
          coords: { x: 800, y: 1000, z: 600 }
        })
        dirLights[2] = addDirLight(scene, {
          color: 0xffffff,
          intensity: 3,
          coords: { x: -450, y: 1000, z: -450 }
        })

        dirLights[0].position.set(500, 1000, 500)
        dirLights[1].position.set(0, 1000, 500)
        dirLights[2].position.set(-500, 1000, -500)
        */

        /*
        spotLight = addSpotLight(scene, {
          color: 0xffffff,
          intensity: 3,
          coords: { x: -450, y: 1000, z: -450 }
        })
        */

        renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(window.innerWidth, window.innerHeight - 34);
        renderer.shadowMap.enabled = false;
        document.body.appendChild(renderer.domElement);

        controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.target.set(100, 100, 100);
        controls.maxPolarAngle = Math.PI / 2
        controls.update();

        vprend = new THREE.WebGLRenderer({ antialias: true });
        vprend.setPixelRatio(window.devicePixelRatio);
        vprend.setSize($('#scene').width(), $('#scene').height());
        vprend.shadowMap.enabled = false;
        document.body.appendChild(vprend.domElement)

        var vcon = new THREE.OrbitControls(vpcam, vprend.domElement);
        vcon.target.set(100, 100, 100);
        vcon.maxPolarAngle = Math.PI / 2
        vcon.update();

        window.addEventListener('resize', onWindowResize, false);
      }

      ptxOptions.position.z = 373
      ptxOptions.position.y = 5
      var dir = 1
      var speed = 12

      function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      }
      function animate() {
        stats.begin()

        if (!vportEmpty) {
          vpobj.rotation.y += 0.01
        }

        var delta = clock.getDelta() * spawnerOptions.timeScale;
        tick += delta;
        if (tick < 0) { tick = 0 }
        if (delta > 0) {
          ptxOptions.position.x = 637

          if (ptxOptions.position.z >= 627) { ptxOptions.position.z = 373 }
          ptxOptions.position.z += (dir * speed)

          for (var x = 0; x < spawnerOptions.spawnRate * delta; x ++) {
            // Yep, that's really it. Spawning particles is super cheap, and once you spawn them, the rest of
            // their lifecycle is handled entirely on the GPU, driven by a time uniform updated below
            particleSystem.spawnParticle(ptxOptions)
          }
        }
        particleSystem.update(tick);

        if (traffic.position.z >= 627) { traffic.position.z = 373 }
        traffic.position.z += (dir * speed)

        stats.end()
        requestAnimationFrame(animate);

        stats.update()
        controls.update()

        renderer.render(scene, camera);
        vprend.render(vport, vpcam);
      }

      // DAT.GUI Related Stuff
      var gui = new dat.GUI();

      var gOptions = {
        grid: {
          visible: false,
          color: 0x01d7d7
        },
        markers: {
          visible: true
        },
        ground: {
          visible: true,
          color: 0x000300,
          reflectivity: 0.85
        },
        lights: {
          hemi: [],
          ambi: {
            visible: true,
            color: 0xffffff,
            intensity: 5
          }
        },
        sidebars: {
          width: 20,
          startColor: 0x477f38,
          endColor: 0x000000,
          startOpacity: 80,
          endOpacity: 0,
        },
        particle: {
          speed: 12,
          posY: 5
        },
        mkGrad: function() {
          var sc = dec2hex(this.sidebars.startColor).substr(2)
          var scR = parseInt(sc.substr(0, 2), 16)
          var scG = parseInt(sc.substr(2, 2), 16)
          var scB = parseInt(sc.substr(4, 2), 16)
          var se = dec2hex(this.sidebars.endColor).substr(2)
          var seR = parseInt(se.substr(0, 2), 16)
          var seG = parseInt(se.substr(2, 2), 16)
          var seB = parseInt(se.substr(4, 2), 16)
          var oS = this.sidebars.startOpacity / 100
          var oE = this.sidebars.endOpacity / 100
          $('.side-left').css('background', '-webkit-gradient(linear, left center, right center, from(rgba(' + scR + ', ' + scG + ', ' + scB + ', ' + oS + ')), to(rgba(' + seR + ', ' + seG + ', ' + seB + ', ' + oE + ')))')
          $('.side-right').css('background', '-webkit-gradient(linear, right center, left center, from(rgba(' + scR + ', ' + scG + ', ' + scB + ', ' + oS + ')), to(rgba(' + seR + ', ' + seG + ', ' + seB + ', ' + oE + ')))')
        },
      };
      var cGl = {}
      for (var ghc = 0; ghc < hemiLights.length; ghc++) {
        gOptions.lights.hemi[ghc] = {
          index: ghc,
          visible: false,
          color: 0xffffff,
          intensity: 1,
          positionX: 0,
          positionY: 1000,
          positionZ: 0
        }
        cGl[ghc] = ghc
      }

      var gGrid = gui.addFolder('Grid');
      gGrid.add(gOptions.grid, 'visible').name('Visible').onChange(function() {
        grid.visible = gOptions.grid.visible
      })
      //gGrid.add(subGrid, 'visible').name('Detail visible').listen()
      gGrid.addColor(gOptions.grid, 'color').name('Color').onChange(function() {
        grid.material.color.setHex(dec2hex(gOptions.grid.color))
      })
      gGrid.add(gOptions.markers, 'visible').name('Markers').onChange(function() {
        markers.visible = gOptions.markers.visible
      })

      /*
      var gGround = gui.addFolder('Ground');
      gGround.add(mrrFadeout, 'visible').name('Visible').listen()
      gGround.addColor(gOptions.ground, 'color').name('Color').onChange(function() {
        mrrFadeout.material.color.setHex(dec2hex(gOptions.ground.color))
      })
      gGround.add(mrrFadeout.material, 'opacity', 0.25, 1).name('Matte').listen()
      */

      ghAmbiLight = gui.addFolder('Ambient light')
      ghAmbiLight.add(gOptions.lights.ambi, 'visible').name('Visibility').onChange(function() {
        ambiLight.visible = gOptions.lights.ambi.visible;
      });
      ghAmbiLight.addColor(gOptions.lights.ambi, 'color').name('Color').onChange(function() {
        ambiLight.color.setHex(dec2hex(gOptions.lights.ambi.color));
      })
      ghAmbiLight.add(gOptions.lights.ambi, 'intensity', 1, 20).name('Intensity').onChange(function() {
        ambiLight.intensity = gOptions.lights.ambi.intensity;
      });

      for (var ghc = 0; ghc < hemiLights.length; ghc++) {
        hemiLights[ghc].visible = false; // They say that girl ya know she act too tough tough tough

        ghLights[ghc] = gui.addFolder('HemisphereLight #' + (ghc + 1))
        ghLights[ghc].add(gOptions.lights.hemi[ghc], 'visible').name('Visibility').onChange(function() {
          hemiLights[this.object.index].visible = gOptions.lights.hemi[this.object.index].visible;
        });
        ghLights[ghc].addColor(gOptions.lights.hemi[ghc], 'color').name('Color').onChange(function() {
          hemiLights[this.object.index].color.setHex(dec2hex(gOptions.lights.hemi[this.object.index].color));
        })
        ghLights[ghc].add(gOptions.lights.hemi[ghc], 'intensity', 1, 20).name('Intensity').onChange(function() {
          hemiLights[this.object.index].intensity = gOptions.lights.hemi[this.object.index].intensity;
        });
        ghLights[ghc].add(gOptions.lights.hemi[ghc], 'positionX', -1000, 1000).name('Position X').onChange(function() {
          hemiLights[this.object.index].position.x = gOptions.lights.hemi[this.object.index].positionX;
        });
        ghLights[ghc].add(gOptions.lights.hemi[ghc], 'positionY', -1000, 1000).name('Position Y').onChange(function() {
          hemiLights[this.object.index].position.y = gOptions.lights.hemi[this.object.index].positionY;
        });
        ghLights[ghc].add(gOptions.lights.hemi[ghc], 'positionZ', -1000, 1000).name('Position Z').onChange(function() {
          hemiLights[this.object.index].position.z = gOptions.lights.hemi[this.object.index].positionZ;
        });
      }

      ghParticle = gui.addFolder('Particles')
      ghParticle.add(ptxOptions, 'velocityRandomness', 0, 3);
      ghParticle.add(ptxOptions, 'positionRandomness', 0, 3);
      ghParticle.add(ptxOptions, 'size', 1, 20);
      ghParticle.add(ptxOptions, 'sizeRandomness', 0, 25);
      ghParticle.add(ptxOptions, 'colorRandomness', 0, 1);
      ghParticle.add(ptxOptions, 'lifetime', 0.1, 20);
      ghParticle.add(ptxOptions, 'turbulence', 0, 1);

      ghParticle.add(spawnerOptions, 'spawnRate', 10, 30000);
      ghParticle.add(spawnerOptions, 'timeScale', -1, 10);

      ghParticle.add(gOptions.particle, 'speed', 1, 100).onChange(function() {
        speed = gOptions.particle.speed
      })
      ghParticle.add(gOptions.particle, 'posY', 1, 200).name('Position Y').onChange(function() {
        ptxOptions.position.y = gOptions.particle.posY
      })

      var gSbars = gui.addFolder('Sidebars')
      gSbars.add(gOptions.sidebars, 'width', 10, 30).onChange(function() {
        $('.side').css('width', gOptions.sidebars.width + 'rem')
      })
      gSbars.addColor(gOptions.sidebars, 'startColor').onChange(function() {
        gOptions.mkGrad()
      })
      gSbars.add(gOptions.sidebars, 'startOpacity', 0, 100).onChange(function() {
        gOptions.mkGrad()
      })
      gSbars.addColor(gOptions.sidebars, 'endColor').onChange(function() {
        gOptions.mkGrad()
      })
      gSbars.add(gOptions.sidebars, 'endOpacity', 0, 100).onChange(function() {
        gOptions.mkGrad()
      })

    </script>
    <script src='./js/helpers/userAdapter.js'></script>



    <div class='holder side side-left info-panel'>
      <div class='container type-form mb-4'>
        <h5>New object</h5>
        <form>
          <div class='form-group'>
            <label for='typeSelect'>Model type</label>
            <select class='form-control' id='typeSelect'>
            </select>
          </div>
          <button id='addBtn' type='button' class='btn btn-primary'>Add</button>
          <button id='addBtnMulti' type='button' class='btn btn-outline-light mx-2'>Add multiple</button>
          <button id='buildBtn' type='button' class='btn btn-outline-success js-btn-build' data-toggle='modal' data-target='.builder-modal-lg'>Build</button>
          <br>
          <button id='loadBtn' type='button' class='btn btn-info mt-2 js-btn-load'>Fetch JSON</button>
          <br>
        </form>
      </div>

      <div class='container type-scene my-4'>
        <h5>Model</h5>
        <div id='scene'></div>
        <aside class='my-3 hide js-ctl'>
          <button id='shInfo' type='button' class='btn btn-outline-light btn-sm mx-1'>Info</button>
          <button id='shConsole' type='button' class='btn btn-outline-light btn-sm mx-1'>Console</button>
          <button id='shGraph' type='button' class='btn btn-outline-light btn-sm mx-1'>Graph</button>
        </aside>
      </div>

      <div class='container type-table my-4'>
        <h5>Objects count</h5>
        <table class='table mw90 w90 w-overflow js-object-list'>
          <thead>
            <tr>
              <th>Object</th>
              <th>Count</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>
    </div>

    <div class='holder side side-right info-panel obj-panel hide'>
      <div class='container type-list mb-4'>
        <h5>Object info</h5>
        <dl class='card-text'>
          <dt>Type</dt>
          <dd class='obj-type'>&middot;</dd>
          <dt>UUID</dt>
          <dd class='obj-uuid'>&middot;</dd>
          <dt>Distance</dt>
          <dd class='obj-dist'>&middot;</dd>
        </dl>
      </div>
      <div class='container type-console my-4'>
        <h5>Console</h5>
        <textarea name='console' id='console' cols='40' rows='10' class='console w100 w-overflow'></textarea>
      </div>
      <div class='container type-graph my-4'>
        <h5>Graph</h5>
        <canvas id='graph'></canvas>
      </div>
    </div>

    <aside id='objttip' class='info-panel ttp-panel hide'>
      <div class='container'>
        Lorem ipsum dolor sit amet, nunc integer.
      </div>
    </aside>

    <aside class='modal fade builder-modal-lg' tabindex='-1' role='dialog' aria-labelledby='builder' aria-hidden='true'>
      <div class='modal-dialog modal-lg'>
        <div class='modal-content'>
          <form id='buildForm'>
            <div class='form-group row'>
              <label for='inputLoc' class='col-sm-2 col-form-label'>Location</label>
              <div class='col-sm-10'>
                <input type='text' class='form-control' id='inputLoc' placeholder='e.g. 3,7' required>
              </div>
            </div>
            <div class='form-group row'>
              <label for='typeSelectM' class='col-sm-2 col-form-label'>Type</label>
              <div class='col-sm-10'>
                <select class='form-control' id='typeSelectM'>
                </select>
              </div>
            </div>
            <div class='form-group row'>
              <label for='logoSelectM' class='col-sm-2 col-form-label'>Logo</label>
              <div class='col-sm-10'>
                <select class='form-control' id='logoSelectM'>
                </select>
              </div>
            </div>
            <div class='form-group row'>
              <div class='col-sm-10'>
                <button type='submit' class='btn btn-primary'>Place</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </aside>


  </body>
</html>
